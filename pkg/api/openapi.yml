openapi: 3.1.0
info:
  title: Formance Simple Wallets Service API
  version: 0.1.0

paths:
  /api/wallets:
    parameters:
      - name: page_size
        in: query
        description: 'The maximum number of results to return per page'
        example: 100
        schema:
          type: integer
          maximum: 1000
          minimum: 1
          default: 15
      - name: after
        in: query
        description: Pagination cursor, will return accounts after given address, in descending order.
        schema:
          type: string
          example: users:003
      - name: pagination_token
        in: query
        description: |
          Parameter used in pagination requests. Maximum page size is set to 15.
          Set to the value of next for the next page of results.
          Set to the value of previous for the previous page of results.
          No other parameters can be set when the pagination token is set.
        schema:
          type: string
          example: aHR0cHM6Ly9nLnBhZ2UvTmVrby1SYW1lbj9zaGFyZQ==

    get:
      summary: Get all wallets
      operationId: getWallets
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Wallet'
    post:
      summary: Create a new wallet
  
  /api/wallets/{id}:
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
    get:
      summary: Get a wallet
      responses:
        200:
          description: Wallet
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Wallet'
        404:
          description: Wallet not found
  
  /api/wallets/{id}/debit:
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
    post:
      summary: Debit a wallet
  
  /api/wallets/{id}/credit:
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
    post:
      summary: Credit a wallet
  
  /api/wallets/{id}/holds:
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
    get:
      summary: Get all holds for a wallet
  
  /api/wallets/{id}/holds/{hold_id}/confirm:
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      - name: hold_id
        in: path
        required: true
        schema:
          type: string
    post:
      summary: Confirm a hold
  
  /api/wallets/{id}/holds/{hold_id}/void:
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      - name: hold_id
        in: path
        required: true
        schema:
          type: string
    post:
      summary: Cancel a hold

components:
  schemas:
    Wallet:
      type: object
      required:
        - name
      properties:
        id:
          type: string
          format: uuid
          description: The unique ID of the wallet.
        counterpartyID:
          type: string
          description: The ID of the wallet's counterparty.
        metadata:
          type: object
          description: Metadata associated with the wallet.
        balances:
          type: object
          description: The balances of the wallet.
          additionalProperties:
            type: number
            description: The balance of the wallet in the specified currency.
    Hold:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: The unique ID of the hold.
        wallet_id:
          type: string
          description: The ID of the wallet the hold is associated with.
        metadata:
          type: object
          description: Metadata associated with the hold.